"use strict";(globalThis.webpackChunkhumanoid_robotic_book=globalThis.webpackChunkhumanoid_robotic_book||[]).push([[191],{299:(e,n,t)=>{t.d(n,{A:()=>l});var o=t(6540);const i="interactiveLessonContainer_pdzt",r="lessonHeader_BiVh",a="lessonMeta_jdmH",s="lessonContent_Ivyb",l=({title:e,chapter:n,lesson:t,children:l})=>o.createElement("div",{className:i},o.createElement("div",{className:r},o.createElement("h1",null,e),o.createElement("div",{className:a},"Chapter ",n,", Lesson ",t)),o.createElement("div",{className:s},l))},5680:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>g});var o=t(6540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,o)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){i(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function s(e,n){if(null==e)return{};var t,o,i=function(e,n){if(null==e)return{};var t,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=o.createContext({}),c=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=c(e.components);return o.createElement(l.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef(function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(t),d=i,g=m["".concat(l,".").concat(d)]||m[d]||u[d]||r;return t?o.createElement(g,a(a({ref:n},p),{},{components:t})):o.createElement(g,a({ref:n},p))});function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,a=new Array(r);a[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[m]="string"==typeof e?e:i,a[1]=s;for(var c=2;c<r;c++)a[c]=t[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},7412:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var o=t(8168),i=(t(6540),t(5680)),r=t(299);const a={sidebar_position:1},s=void 0,l={unversionedId:"chapter2/lesson1/ros2-architecture",id:"chapter2/lesson1/ros2-architecture",title:"ros2-architecture",description:"In this comprehensive lesson, you'll dive deep into the Robot Operating System 2 (ROS 2) architecture, which forms the nervous system of humanoid robots. ROS 2 provides the middleware framework that enables different components of your robot to communicate effectively.",source:"@site/docs/chapter2/lesson1/ros2-architecture.mdx",sourceDirName:"chapter2/lesson1",slug:"/chapter2/lesson1/ros2-architecture",permalink:"/humanoid_robotic_book/docs/chapter2/lesson1/ros2-architecture",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"mySidebar",previous:{title:"index",permalink:"/humanoid_robotic_book/docs/chapter2/"},next:{title:"humanoid-robot-modeling",permalink:"/humanoid_robotic_book/docs/chapter2/lesson2/humanoid-robot-modeling"}},c={},p=[{value:"Introduction to ROS 2",id:"introduction-to-ros-2",level:2},{value:"Key Improvements in ROS 2",id:"key-improvements-in-ros-2",level:3},{value:"Core Architecture Components",id:"core-architecture-components",level:2},{value:"Nodes",id:"nodes",level:3},{value:"Creating a Node in Python",id:"creating-a-node-in-python",level:4},{value:"Topics",id:"topics",level:3},{value:"Topic Communication in Humanoid Robots",id:"topic-communication-in-humanoid-robots",level:4},{value:"Example: Publishing Joint States",id:"example-publishing-joint-states",level:4},{value:"Services",id:"services",level:3},{value:"Service Communication in Humanoid Robots",id:"service-communication-in-humanoid-robots",level:4},{value:"Example: Creating a Service Server",id:"example-creating-a-service-server",level:4},{value:"Advanced ROS 2 Concepts",id:"advanced-ros-2-concepts",level:2},{value:"Actions",id:"actions",level:3},{value:"Action Example for Humanoid Robot Walking",id:"action-example-for-humanoid-robot-walking",level:4},{value:"Parameters",id:"parameters",level:3},{value:"Lifecycle Nodes",id:"lifecycle-nodes",level:3},{value:"Best Practices for ROS 2 in Humanoid Robotics",id:"best-practices-for-ros-2-in-humanoid-robotics",level:2},{value:"1. Message Design",id:"1-message-design",level:3},{value:"2. Node Architecture",id:"2-node-architecture",level:3},{value:"3. Performance Optimization",id:"3-performance-optimization",level:3},{value:"4. Security Considerations",id:"4-security-considerations",level:3},{value:"Hands-on Exercise",id:"hands-on-exercise",level:2},{value:"Quiz Questions",id:"quiz-questions",level:2}],m={toc:p},u="wrapper";function d({components:e,...n}){return(0,i.yg)(u,(0,o.A)({},m,n,{components:e,mdxType:"MDXLayout"}),(0,i.yg)(r.A,{title:"ROS 2 Architecture (Nodes, Topics, Services)",chapter:2,lesson:1,mdxType:"InteractiveLesson"},(0,i.yg)("h1",{id:"ros-2-architecture-nodes-topics-services"},"ROS 2 Architecture (Nodes, Topics, Services)"),(0,i.yg)("p",null,"In this comprehensive lesson, you'll dive deep into the Robot Operating System 2 (ROS 2) architecture, which forms the nervous system of humanoid robots. ROS 2 provides the middleware framework that enables different components of your robot to communicate effectively."),(0,i.yg)("h2",{id:"introduction-to-ros-2"},"Introduction to ROS 2"),(0,i.yg)("p",null,"ROS 2 is the next-generation Robot Operating System that addresses the limitations of ROS 1, particularly in terms of security, real-time performance, and multi-robot systems. It's built on Data Distribution Service (DDS), which provides a publish-subscribe communication pattern ideal for distributed robotic systems."),(0,i.yg)("h3",{id:"key-improvements-in-ros-2"},"Key Improvements in ROS 2"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Security"),": Built-in security features for protecting robot systems"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Real-time Support"),": Deterministic behavior for time-critical applications"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Multi-robot Systems"),": Native support for complex multi-robot coordination"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Cross-platform Compatibility"),": Runs on various operating systems including Linux, Windows, and macOS"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Container Support"),": Better integration with Docker and other container technologies")),(0,i.yg)("h2",{id:"core-architecture-components"},"Core Architecture Components"),(0,i.yg)("h3",{id:"nodes"},"Nodes"),(0,i.yg)("p",null,"Nodes are the fundamental building blocks of a ROS 2 system. Each node represents a single process that performs specific computation. In humanoid robots, different nodes might handle:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Sensor Processing"),": Nodes that process data from cameras, IMUs, LiDARs, etc."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Motion Control"),": Nodes that handle joint control and trajectory planning"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Perception"),": Nodes that perform object detection, SLAM, and scene understanding"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Planning"),": Nodes that handle path planning and task scheduling"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Communication"),": Nodes that handle external communication and user interfaces")),(0,i.yg)("h4",{id:"creating-a-node-in-python"},"Creating a Node in Python"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},"import rclpy\nfrom rclpy.node import Node\n\nclass HumanoidRobotNode(Node):\n    def __init__(self):\n        super().__init__('humanoid_robot_node')\n        self.get_logger().info('Humanoid Robot Node initialized')\n\n    def shutdown(self):\n        self.get_logger().info('Shutting down Humanoid Robot Node')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_node = HumanoidRobotNode()\n\n    try:\n        rclpy.spin(robot_node)\n    except KeyboardInterrupt:\n        robot_node.get_logger().info('Interrupted by user')\n    finally:\n        robot_node.shutdown()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n")),(0,i.yg)("h3",{id:"topics"},"Topics"),(0,i.yg)("p",null,"Topics enable asynchronous communication between nodes using a publish-subscribe pattern. Data flows from publishers to subscribers through topics, allowing for loose coupling between different parts of the robot system."),(0,i.yg)("h4",{id:"topic-communication-in-humanoid-robots"},"Topic Communication in Humanoid Robots"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Sensor Data"),": IMU readings, camera images, and LiDAR scans published to topics"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Control Commands"),": Joint position, velocity, and effort commands sent via topics"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"State Information"),": Robot pose, joint states, and battery status published regularly"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Event Notifications"),": System status changes, error conditions, and warnings")),(0,i.yg)("h4",{id:"example-publishing-joint-states"},"Example: Publishing Joint States"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},"from sensor_msgs.msg import JointState\nimport rclpy\nfrom rclpy.node import Node\n\nclass JointStatePublisher(Node):\n    def __init__(self):\n        super().__init__('joint_state_publisher')\n        self.publisher = self.create_publisher(JointState, 'joint_states', 10)\n        self.timer = self.create_timer(0.1, self.publish_joint_states)\n\n    def publish_joint_states(self):\n        msg = JointState()\n        msg.name = ['left_hip', 'left_knee', 'right_hip', 'right_knee']\n        msg.position = [0.1, 0.2, 0.15, 0.25]\n        msg.header.stamp = self.get_clock().now().to_msg()\n        self.publisher.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    publisher = JointStatePublisher()\n    rclpy.spin(publisher)\n    publisher.destroy_node()\n    rclpy.shutdown()\n")),(0,i.yg)("h3",{id:"services"},"Services"),(0,i.yg)("p",null,"Services provide synchronous request-response communication between nodes. Unlike topics, services block the calling node until a response is received, making them suitable for operations that require immediate feedback."),(0,i.yg)("h4",{id:"service-communication-in-humanoid-robots"},"Service Communication in Humanoid Robots"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Calibration"),": Requesting sensor calibration and receiving confirmation"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Initialization"),": Service calls to initialize different subsystems"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Emergency Stop"),": Service calls to immediately stop robot motion"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Configuration"),": Changing robot parameters and receiving status")),(0,i.yg)("h4",{id:"example-creating-a-service-server"},"Example: Creating a Service Server"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},"from humanoid_robot_msgs.srv import RobotCalibration\nimport rclpy\nfrom rclpy.node import Node\n\nclass CalibrationService(Node):\n    def __init__(self):\n        super().__init__('calibration_service')\n        self.srv = self.create_service(\n            RobotCalibration,\n            'robot_calibration',\n            self.calibrate_robot_callback\n        )\n\n    def calibrate_robot_callback(self, request, response):\n        self.get_logger().info(f'Calibrating robot with mode: {request.mode}')\n        # Perform calibration logic here\n        response.success = True\n        response.message = 'Calibration completed successfully'\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    service = CalibrationService()\n    rclpy.spin(service)\n    service.destroy_node()\n    rclpy.shutdown()\n")),(0,i.yg)("h2",{id:"advanced-ros-2-concepts"},"Advanced ROS 2 Concepts"),(0,i.yg)("h3",{id:"actions"},"Actions"),(0,i.yg)("p",null,"Actions are goal-oriented communication patterns that are perfect for long-running tasks like navigation or manipulation. They provide feedback during execution and can be preempted if needed."),(0,i.yg)("h4",{id:"action-example-for-humanoid-robot-walking"},"Action Example for Humanoid Robot Walking"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},"from rclpy.action import ActionServer\nfrom humanoid_robot_msgs.action import WalkToGoal\nimport rclpy\nfrom rclpy.node import Node\n\nclass WalkActionServer(Node):\n    def __init__(self):\n        super().__init__('walk_action_server')\n        self._action_server = ActionServer(\n            self,\n            WalkToGoal,\n            'walk_to_goal',\n            self.execute_callback\n        )\n\n    def execute_callback(self, goal_handle):\n        feedback_msg = WalkToGoal.Feedback()\n        result = WalkToGoal.Result()\n\n        # Execute walking logic here\n        for i in range(0, 100):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                result.success = False\n                return result\n\n            feedback_msg.progress = i\n            goal_handle.publish_feedback(feedback_msg)\n\n        goal_handle.succeed()\n        result.success = True\n        return result\n")),(0,i.yg)("h3",{id:"parameters"},"Parameters"),(0,i.yg)("p",null,"Parameters allow runtime configuration of nodes and can be changed without restarting the system. This is crucial for humanoid robots that need to adapt to different environments or tasks."),(0,i.yg)("h3",{id:"lifecycle-nodes"},"Lifecycle Nodes"),(0,i.yg)("p",null,"Lifecycle nodes provide a structured way to manage the state of complex robot systems, with defined transitions between unconfigured, inactive, active, and finalized states."),(0,i.yg)("h2",{id:"best-practices-for-ros-2-in-humanoid-robotics"},"Best Practices for ROS 2 in Humanoid Robotics"),(0,i.yg)("h3",{id:"1-message-design"},"1. Message Design"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Use appropriate message types for your data"),(0,i.yg)("li",{parentName:"ul"},"Design custom messages for complex data structures"),(0,i.yg)("li",{parentName:"ul"},"Consider bandwidth and real-time constraints")),(0,i.yg)("h3",{id:"2-node-architecture"},"2. Node Architecture"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Keep nodes focused on single responsibilities"),(0,i.yg)("li",{parentName:"ul"},"Use composition for complex systems"),(0,i.yg)("li",{parentName:"ul"},"Implement proper error handling and recovery")),(0,i.yg)("h3",{id:"3-performance-optimization"},"3. Performance Optimization"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Use appropriate QoS settings for different data types"),(0,i.yg)("li",{parentName:"ul"},"Optimize message frequency based on application needs"),(0,i.yg)("li",{parentName:"ul"},"Consider using intra-process communication for high-frequency data")),(0,i.yg)("h3",{id:"4-security-considerations"},"4. Security Considerations"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Enable ROS 2 security features for production systems"),(0,i.yg)("li",{parentName:"ul"},"Use appropriate authentication and encryption"),(0,i.yg)("li",{parentName:"ul"},"Implement network segmentation for critical systems")),(0,i.yg)("h2",{id:"hands-on-exercise"},"Hands-on Exercise"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Create a simple ROS 2 package for your humanoid robot"),(0,i.yg)("li",{parentName:"ol"},"Implement a node that publishes joint states"),(0,i.yg)("li",{parentName:"ol"},"Create a subscriber node that receives and processes these states"),(0,i.yg)("li",{parentName:"ol"},"Add a service that allows changing the robot's operational mode"),(0,i.yg)("li",{parentName:"ol"},"Test your nodes using ",(0,i.yg)("inlineCode",{parentName:"li"},"ros2 run")," and ",(0,i.yg)("inlineCode",{parentName:"li"},"ros2 topic")," commands")),(0,i.yg)("h2",{id:"quiz-questions"},"Quiz Questions"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"What is the difference between topics and services in ROS 2?"),(0,i.yg)("li",{parentName:"ol"},"Why is DDS important for ROS 2 architecture?"),(0,i.yg)("li",{parentName:"ol"},"What are the advantages of using actions over topics for navigation tasks?"))))}d.isMDXComponent=!0}}]);